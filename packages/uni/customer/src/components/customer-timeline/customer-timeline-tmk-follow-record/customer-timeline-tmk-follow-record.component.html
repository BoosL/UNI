<ngx-excel-context readonly scene="table" [context]="record" [excel]="excel">
  <div class="ant-row">
    <div class="ant-col-3">
      <ngx-excel-cell headCell [column]="rules.nextFollowTime"></ngx-excel-cell>
    </div>
    <div class="ant-col-5">
      <ngx-excel-cell normalCell [column]="rules.nextFollowTime"></ngx-excel-cell>
    </div>
    <div class="ant-col-3">
      <ngx-excel-cell headCell [column]="rules.status"></ngx-excel-cell>
    </div>
    <div class="ant-col-5">
      <ngx-excel-cell normalCell [column]="rules.status" [template]="statusTpl"></ngx-excel-cell>
    </div>
    <div class="ant-col-3">
      <ngx-excel-cell headCell [column]="rules.nextVisitedTime"></ngx-excel-cell>
    </div>
    <div class="ant-col-5">
      <ngx-excel-cell normalCell [column]="rules.nextVisitedTime"></ngx-excel-cell>
    </div>
  </div>
  <div class="ant-row">
    <div class="ant-col-3">
      <ngx-excel-cell headCell [column]="rules.school"></ngx-excel-cell>
    </div>
    <div class="ant-col-5">
      <ngx-excel-cell normalCell [column]="rules.school"></ngx-excel-cell>
    </div>
  </div>
  <div class="ant-row">
    <div class="ant-col-3">
      <ngx-excel-cell headCell [column]="rules.content"></ngx-excel-cell>
    </div>
    <div class="ant-col-21">
      <ngx-excel-cell normalCell [column]="rules.content"></ngx-excel-cell>
    </div>
  </div>
</ngx-excel-context>

<ng-template #statusTpl let-context="context">
  <div *ngIf="!context.status && !context.endCode" class="cell text-warning"> 未设置</div>
  <div *ngIf="context.status || context.endCode" class="cell">
    <span [class.text-warning]="!context?.status"> {{ context?.status?.label || '未设置' }} </span>
    -
    <span [class.text-warning]="!context?.endCode"> {{ context?.endCode?.label || '未设置' }} </span>
  </div>
</ng-template>
