<ngx-excel-context *ngIf="visible" [(context)]="context" [attachSelectTo]="attachSelectTo" (contextChange)="handleContextChange($event)">
  <div class="ant-row">
    <ng-container *ngIf="!invisibleDeposit">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.hasDeposit"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [disabled]="cantEditDeposit" [column]="rules.hasDeposit">
        </ngx-excel-cell>
      </div>
    </ng-container>
    <ng-container *ngIf="!invisibleCc">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.cc"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.cc" [template]="columnCcTpl"></ngx-excel-cell>
      </div>
    </ng-container>
    <ng-container *ngIf="!invisibleCd">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.cd"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.cd"></ngx-excel-cell>
      </div>
    </ng-container>
  </div>
</ngx-excel-context>

<ng-template #columnCcTpl let-value="value">
  <ng-container *ngIf="cantEditCc">
    <div class="cell text-optional"> (当前状态无法分配CC) </div>
  </ng-container>
  <ng-container *ngIf="!cantEditCc">
    <div class="cell" [class.text-warning]="!value"> {{ value?.name || '未设置' }} </div>
  </ng-container>
</ng-template>
