<portlet title="基本信息" noPadding class="table">
  <ng-template portletBody>
    <ng-container *ngTemplateOutlet="basicInfoTpl; context: { employee: employee$ | async }"></ng-container>
  </ng-template>
</portlet>

<ng-template #basicInfoTpl let-employee="employee">
  <ngx-excel-context [context]="employee" (contextChange)="handleEmployeeChange($event)">
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.nameCn"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.nameCn"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.nameEn"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.nameEn"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.loginName"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.loginName"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.phoneNumber"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.phoneNumber"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.officeNumber"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.officeNumber"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.backupPhoneNumber"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.backupPhoneNumber"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.email"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.email"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.qq"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell [column]="rules.qq"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.idCardNum"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.idCardNum"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.address"></ngx-excel-cell>
      </div>
      <div class="ant-col-21">
        <ngx-excel-cell normalCell [column]="rules.address"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.school"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.school"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.relativeSchools"></ngx-excel-cell>
      </div>
      <div class="ant-col-13">
        <ngx-excel-cell normalCell disabled [column]="rules.relativeSchools"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.status"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.status"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.entryDate"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.entryDate"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.departureDate"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ngx-excel-cell normalCell disabled [column]="rules.departureDate"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.score"></ngx-excel-cell>
      </div>
      <div class="ant-col-13">
        <ng-template #columnScoreTpl let-value="value">
          <ng-container *ngIf="employeeService.isTeacherRole(employee); else nonTeacherTpl;">
            <div class="cell cell-score">
              <nz-rate nzAllowHalf nzDisabled [ngModel]="value"></nz-rate>
            </div>
          </ng-container>
        </ng-template>
        <ngx-excel-cell normalCell disabled [column]="rules.score" [template]="columnScoreTpl"></ngx-excel-cell>
      </div>
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.scoreCount"></ngx-excel-cell>
      </div>
      <div class="ant-col-5">
        <ng-template #columnScoreCountTpl let-value="value">
          <ng-container *ngIf="employeeService.isTeacherRole(employee); else nonTeacherTpl;">
            <div class="cell"> {{ value }} </div>
          </ng-container>
        </ng-template>
        <ngx-excel-cell normalCell disabled [column]="rules.scoreCount" [template]="columnScoreCountTpl"></ngx-excel-cell>
      </div>
    </div>
    <div class="ant-row">
      <div class="ant-col-3">
        <ngx-excel-cell headCell [column]="rules.styles"></ngx-excel-cell>
      </div>
      <div class="ant-col-21">
        <ng-template #columnStylesTpl let-value="value">
          <ng-container *ngIf="employeeService.isTeacherRole(employee); else nonTeacherTpl;">
            <div class="cell"> {{ value | ngxExcelMultiItem:'label':10 }} </div>
          </ng-container>
        </ng-template>
        <ngx-excel-cell normalCell [column]="rules.styles" [template]="columnStylesTpl"></ngx-excel-cell>
      </div>
    </div>
  </ngx-excel-context>
</ng-template>

<ng-template #nonTeacherTpl>
  <div class="cell text-optional"> 非老师角色无该项显示 </div>
</ng-template>